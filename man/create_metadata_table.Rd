% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_metadata_flextable.R
\name{create_metadata_table}
\alias{create_metadata_table}
\title{Create a metadata flextable for a dataset}
\usage{
create_metadata_table(df, fontname = NULL, fontsize = NULL)
}
\arguments{
\item{df}{A data.frame with optional metadata attributes.}

\item{fontname}{Optional font name to apply to the entire table.}

\item{fontsize}{Optional font size to apply to the entire table.}
}
\value{
A \code{flextable} object summarizing the dataset.
}
\description{
Builds a formatted metadata table summarizing the structure and content of a dataset.
The table includes variable names, types, units, descriptions, and summary statistics.
It is designed to render well in HTML using the \code{flextable} package.
}
\details{
The dataset can include metadata as attributes:
\itemize{
\item A \code{"description"} attribute on the dataset itself
\item \code{"description"} and \code{"unit"} attributes on individual columns
}

This function assumes that variable descriptions and units have been added as attributes using
\code{\link[=add_desc]{add_desc()}} and \code{\link[=add_unit]{add_unit()}}, and that dataset-level descriptions have been set using \code{\link[base:attr]{base::attr()}}.
}
\examples{
# Load required packages
library(flextable)
library(dplyr)

# Create dataset and define descriptions and units for variables
df1 <- iris \%>\%
  add_desc(Sepal.Length = "Sepal length [cm]",  # units in square brackets are stored as unit attributes
           Sepal.Width  = "Sepal width",        # unit can be added separately
           Petal.Length = "Petal.Length [cm]",
           Petal.Width  = "Petal.Width [cm]",
           Species      = "Four Iris species") \%>\%
  add_unit(Sepal.Width = "cm")  # add unit if not set by add_desc

# Add dataset-level description
attr(df1, "description") <- "Sepal and petal lengths and widths measured on Iris species."

# Create metadata table
ft <- create_metadata_table(df1)
ft

# Save table as HTML
flextable::save_as_html(ft, path = "df1_metadata.html")

}
\seealso{
\code{\link[=add_unit]{add_unit()}},\code{\link[=add_desc]{add_desc()}}, \code{\link[flextable:flextable]{flextable::flextable()}}
}
